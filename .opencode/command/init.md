---
description: Initialize CliKit and craft a high-quality AGENTS.md for this project.
agent: build
---

You are running `/init` for this repository.

Goal: set up CliKit and produce a **carefully written** `AGENTS.md` (not autogenerated fluff).

## Execution Plan

### 1) Detect project context first (parallel)

Run focused discovery to identify:
- runtime/language/framework
- package manager + canonical install/test/build/lint/typecheck commands
- monorepo vs single app
- key top-level directories and entry points
- existing guidance files (`AGENTS.md`, `CLAUDE.md`, `README*`, `CONTRIBUTING*`)

### 2) Install plugin + entrypoint

Install `clikit-plugin` with the project’s package manager.

Create/ensure `.opencode/index.ts`:

```ts
import CliKitPlugin from "clikit-plugin";

export default CliKitPlugin;
```

### 3) Create `.opencode` structure

Ensure these exist:
- `.opencode/memory/specs`
- `.opencode/memory/plans`
- `.opencode/memory/research`
- `.opencode/memory/reviews`
- `.opencode/memory/handoffs`
- `.opencode/memory/prds`
- `.opencode/memory/beads`
- `.opencode/memory/_templates`

### 4) Handle existing AGENTS.md safely

If root `AGENTS.md` exists:
1. Read it.
2. Audit briefly for relevance/conciseness.
3. Ask before replacing.

If none exists, create one directly.

### 5) Write AGENTS.md (high-signal only)

Use **WHAT / WHY / HOW** and keep it concise.

Required sections:
1. `# <Project Name>`
2. 1–2 lines: what this project is and why it exists
3. `## Stack`
4. `## Project Structure` (compact map of important dirs)
5. `## Development` (only core universal commands)
6. `## Where to Find More` (progressive disclosure pointers)

Quality constraints:
- target **< 60 lines**
- include only universally applicable guidance
- no task-specific playbooks
- no style-guide/linter content
- no stale code snippets when a file reference is better
- prefer pointers to authoritative files

### 6) Validate result

Check:
- plugin entrypoint exists and imports `clikit-plugin`
- AGENTS.md exists at project root
- AGENTS.md length and clarity are within target

### 7) Final response format

Return:

```markdown
## CliKit Initialized

✅ Plugin installed
✅ Entry point configured
✅ Memory directories ready
✅ AGENTS.md created/updated

### AGENTS.md Quality
- Lines: <count>
- Universally applicable: yes/no
- Progressive disclosure pointers: yes/no

### Next
1. Restart OpenCode
2. Run /create to begin work
```

## Important behavior

- Be deliberate: AGENTS.md is high-leverage context for every session.
- Prefer concise, accurate, project-specific instructions over long generic rules.
- Do not overwrite existing AGENTS.md without explicit confirmation.
